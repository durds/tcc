var math = require('mathjs')

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////Base de dados ////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const U_L =   [0,  100,  200,  300,  400,  500,  600,  700,  800,  900,  1000] // Universo dos valores de Luminosidade
const VL_L = [[1,  0.2,    0,    0,    0,    0,    0,    0,    0,    0,     0], //0 baixa
              [0,  0.8,  0.2,    0,    0,    0,    0,    0,    0,    0,     0], //1 baixa media
              [0,    0,  0.4,  0.8,  0.1,    0,    0,    0,    0,    0,     0], //2 baixa alta
              [0,    0,    0,    0,  0.6,    1,  0.2,    0,    0,    0,     0], //3 media
              [0,    0,    0,    0,    0,    0,  0.4,    0,  0.3,    0,     0], //4 alta baixa
              [0,    0,    0,    0,    0,    0,    0,  0.8,  0.5,  0.8,     0], //5 alta media
              [0,    0,    0,    0,    0,    0,    0,    0,    0,    0,     1]] //6 alta


const U_V =   [-10,   -8,   -6,   -4,   -2,   0,   2,   4,   6,   8,   10] // Universo dos valores de Variação da Luminosidade
const VL_V = [[1,    0.8,  0.6,  0.4,  0.2,   0,   0,   0,   0,   0,    0], //0 alta p baixo
              [0,      0,    0,  0.2,  0.6,   1, 0.8, 0.4, 0.2,   0,    0], //1 baixa
              [0,      0,    0,    0,    0,   0,   0, 0.2, 0.6, 0.8,    1]] //2 alta p cima


const U_A =   [0,     31,   63,   95,  127, 159, 191, 223, 255] // Universo dos valores de Ação(pwm)
const VL_A = [[1,      0,    0,    0,    0,   0,   0,   0,   0], //0 baixo
              [0,    0.2,  0.4,  0.6,  0.3,   0,   0,   0,   0], //1 medio baixo
              [0,      0,    0,  0.3,    1, 0.5,   0,   0,   0], //2 medio
              [0,      0,    0,    0,    0, 0.2, 0.5, 0.8,   0], //3 medio alto
              [0,      0,    0,    0,    0,   0,   0,   0,   1]] //4 alto

const BR = [[0, 0, 4],
            [1, 0, 4],
            [2, 0, 4],
            [3, 0, 2],
            [4, 0, 0],
            [5, 0, 0],
            [6, 0, 0],
            
            [0, 1, 3],
            [1, 1, 3],
            [2, 1, 2],
            [3, 1, 2],
            [4, 1, 2],
            [5, 1, 1],
            [6, 1, 0],
            
            [0, 2, 4],
            [1, 2, 4],
            [2, 2, 3],
            [3, 2, 2],
            [4, 2, 1],
            [5, 2, 0],
            [6, 2, 0]]

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////Fuzificação////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


//Achar qual dos valores do universo o valor medido de luminosidade faz parte
var lum_temp = U_L[0]
var Lum_medida = 0
var i = 0
for(i = 1; i < U_L.length; i++) {
    if(temp <= math.abs(U_L[i]-Lum_medida)) {
        break
    } else {
        temp = math.abs(U_L[i]-Lum_medida)
    }
        
}

var lum_fuzzy = i - 1
var medida_anterior = Lum_medida

//Achar qual dos valores do universo o valor da variação da mediada faz parte 

var var_temp = U_V[0]

var variac = 